---
title: "econ_hw2"
author: "David Segan"
date: "4/22/2020"
output: html_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

```{r}

# Load libraries and bring in data

library(tidyverse)
library(janitor)
library(stargazer)

mc_sector <- readxl::read_xlsx("HW2_Data.xlsx") %>% 
  clean_names()

```

### Question 1
##### Sector A

```{r}
# ----------------
# Sector A - MC curve
# ----------------

sector_a <- mc_sector %>% 
  select(abatement, mc_a)

sector_a_plot <- ggplot(sector_a, aes(x = abatement, y = mc_a)) + 
  geom_line() +
  labs(title = "Sector A estimates for marginal cost of abatement by abatement levels",
       x = "Abatement (Tons)",
       y = "Marginal Cost")

sector_a_plot

```

Marginal Cost = (m)*Abatement + (b)

```{r}
# -----------------
# Sector A - linear model overlayed with MC curve
# -----------------

lm_sector_a <- lm(mc_a ~ abatement, data = sector_a)
  
predict_df_a <- predict(lm_sector_a, sector_a)

df_a <- data.frame(sector_a, predict_df_a)

ggplot() +
  geom_line(data = lm_sector_a,
             aes(x = abatement,
                 y = mc_a),
             color = "coral",
             size = 1, 
             alpha = 1) +
  geom_line(data = df_a,
            aes(x = abatement,
                y = predict_df_a)) +
  theme_light() +
  labs(title = "Sector A predicted marginal cost of abatement by abatement levels",
       x = "Abatement (Tons)",
       y = "Marginal Cost")
```

```{r, results = "asis"}

# -----------
# Sector A - Linear model stats
# -----------

stargazer(lm_sector_a, type = "html")
```

##### Sector D

```{r}
# ----------------
# Sector D - MC curve
# ----------------

sector_d <- mc_sector %>% 
  select(abatement, mc_d)

sector_d_plot <- ggplot(sector_d, aes(x = abatement, y = mc_d)) + 
  geom_line() +
  labs(title = "Sector D estimates for marginal cost of abatement by abatement levels",
       x = "Abatement (Tons)",
       y = "Marginal Cost")

sector_d_plot
```
```{r}
# -----------------
# Sector D - linear model overlayed with MC curve
# -----------------

lm_sector_d <- lm(mc_d ~ abatement, data = sector_d)

poly_sector_d <- lm(mc_d ~ poly(abatement, 3, data = sector_d))
  
predict_df_d <- predict(lm_sector_d, sector_d)

df_a <- data.frame(sector_d, predict_df_d)

ggplot() +
  geom_line(data = lm_sector_d,
             aes(x = abatement,
                 y = mc_d),
             color = "coral",
             size = 1, 
             alpha = 1) +
  geom_line(data = df_d,
            aes(x = abatement,
                y = predict_df_d)) +
  theme_light() +
  labs(title = "Sector D predicted marginal cost of abatement by abatement levels",
       x = "Abatement (Tons)",
       y = "Marginal Cost")
```

### Question 2
##### Demand for emissions

```{r}

a_coeff = 0.513
a_const = 1.655
a_emissions_current = 170

a_supply <- function(x) {y = a_coeff*x + a_const}

a_demand <- function(x) {y = a_coeff*(a_emissions_current-a_emissions_new)+a_const}


```

